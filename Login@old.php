<?phpdefined('BASEPATH') OR exit('No direct script access allowed');class Login extends CI_Controller{    var $data;	    function  __construct()     {        parent::__construct();        $this->load->library('admin_init_elements');        $this->admin_init_elements->init_elements();        $this->load->model('login_model');        $this->load->model('client_project_model');        $this->load->helper('url');            }   function index()   {               $this->load->helper('url');        $data = array();        $data['error_message']   = "";        $data['success_message'] = "";                $is_admin_logged_in = $this->session->userdata('is_admin_logged_in');        if($is_admin_logged_in == TRUE)        {                        redirect(base_url().'index.php/Manageproject/index');        }                if($this->session->userdata('error_message')!="")        {                $data['error_message'] = $this->session->userdata('error_message');                $this->session->unset_userdata('error_message');        }        if($this->session->userdata('success_message')!="")        {                $data['success_message']=$this->session->userdata('success_message');                $this->session->unset_userdata('success_message');                $this->session->sess_destroy();        }                        $this->load->view('index', $data);    }    function userlogin()    {        $this->load->helper('url');        $this->load->view('userlogin', $data);    }     // Admin authentication ----------    function validate_admin_login()    {        $this->load->helper('url');        $this->load->model('login_model');        $query = $this->login_model->validate_admin_login();        if($query)        {                // prepare session variables                $data = Array (                                    'is_admin_logged_in' => true,                                    'admin_user_name' => $this->input->post('username'),                                    'success_message'=>'Logged in Successfully'                           );                $this->session->set_userdata($data);                  $redirectUrl = "";                $redirectUrl = $this->input->post('url');                if($this->session->userdata('member_type')=='1')                {                 //redirect(base_url('dashboard'));                       redirect(base_url().'Manageproject/');                }                else                {                    redirect(base_url().'Manageproject/');                }                                    }    else    {                $data = Array ('error_message'=>'Invalid login Details, Please Try Again');                $this->session->set_userdata($data);                redirect(base_url().'Login/userlogin');        }    }	    function signup()    {                //echo "heiill";die();                $this->load->helper('url');                $this->load->model('login_model');                $data = array();                $data['error_message']   = "";                if ($this->input->post('signup'))                {                    $exitEmailId = $this->login_model->is_exist_emailId($this->input->post('memberEmail'));                    //echo $exitEmailId;die();                    if($exitEmailId=='0')                    {                        $singupArray=array(                       'memberUsername'=> $this->input->post('username'),                       'memberName'=> $this->input->post('username'),                       'memberEmail'=> $this->input->post('memberEmail'),                       'memberPass'=> md5($this->input->post('password')),                       'isActive'=>'1',                       'createdOn'=> date('Y-m-d h:i:s')                        );                        $result = $this->login_model->userSignup();                                           if($result)                        {                            $this->validate_admin_login();                        redirect(base_url().'index.php/Manageproject/index');                        }                                           //$this->load->view('usersignup');                             //exit();                    }              else {                $data['checkEmail'] = Array ('email_message_error'=>'Email Address allready exit,Please enter email address');                //$this->session->set_userdata($data);                                    $this->load->view('usersignup',$data);                        }             }             else             {                              $this->load->helper('url');             $this->load->view('usersignup');                 }    }	function ForgotPassword()	{	   $this->load->model('login_model');				if ($this->input->post('forgetPassword'))        {			$exitEmailId = $this->login_model->is_exist_emailId($this->input->post('memberEmail'));			if($exitEmailId=='0')               {			   $data['checkEmail'] = Array ('email_message_error'=>'Email Address does not Match ,Please enter email address');                //$this->session->set_userdata($data);                                    $this->load->view('forget_password',$data); 							}				else				{			$exitEmailId = $this->login_model->SendNewPass($this->input->post('memberEmail'));			   $data['checkEmail'] = Array ('email_message_error'=>"New Password has been send to your email address.");				$this->load->view('forget_password',$data);				}					}				//$this->data['maincontent'] = $this->load->view('admin/maincontents/forgotpass',$data,TRUE);        //render full layout, specific to this function        $this->load->view('forget_password');	}		function is_exist($str) //callback function for validation rule (called from model) for checking uniqueness of key data       {        if ($this->login_model->is_exist($str) == TRUE)        {            $this->form_validation->set_message('is_exist', 'This Email Does not exist');            return FALSE;        }        else        {            return TRUE;        }      }	        public function user_details()    {		        $memberId = $this->session->userdata('memberId');        $this->load->helper('url');		$projectId=$this->uri->segment(3);		if($this->input->post('Updatedetails'))		{			//echo "hiii";die();		$data['checkEmail'] = Array ('email_message_error'=>"Update Successfully.");			$this->login_model->update_userdetails($memberId);						if($this->input->post('username')!='')			{				$this->login_model->update_user_password($memberId);			}		$data['projectDetails'] = $this->login_model->get_project_details($projectId);		$data['userDetails'] = $this->login_model->getUserDetails($memberId);                $this->load->view('manage-project/user_details',$data);		}		else{			//echo "hello";die();		$data['projectId']=$projectId;        $data['memberId']=$memberId;		$data['projectDetails'] = $this->login_model->get_project_details($projectId);        $data['userDetails'] = $this->login_model->getUserDetails($memberId);        //print_r($data);die();        $this->load->helper('url');        //$this->load->view('header');        $this->load->view('manage-project/user_details',$data);		}    }    function logout()    {                $this->load->helper('url');        //Code added        $data = Array ('success_message'=>'Logged out Successfully');        $this->session->set_userdata($data);        $this->session->unset_userdata('is_admin_logged_in');        redirect(base_url().'index.php/Login');        //        /*	$adminid = $this->session->userdata('memberId');        if(isset($is_admin_logged_in) || $is_admin_logged_in == TRUE)        {			$data = Array ('success_message'=>'Logged out Successfully');			$this->session->set_userdata($data);									$this->session->unset_userdata('is_admin_logged_in');			                        redirect(base_url().'index.php/Login');        }         */    }    }?>